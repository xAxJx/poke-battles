<% query = @search.to_s.strip %>
<% query_label = query.present? ? query.upcase : "ALL" %>

<section class="landing pokemon-search">
  <div class="landing-shell">
    <div class="landing-screen">
      <div class="screen-header">
        <p class="screen-title">Pokemon Search</p>
        <span class="query-pill">Query: <%= query_label %></span>
      </div>

      <div class="screen-body">
        <%= form_with url: "search", method: :get, class: "gb-search" do |f| %>
          <%= f.label :search, "Search again:", class: "gb-search-label" %>
          <div class="gb-search-row">
            <%= f.search_field :search, class: "gb-search-input", value: @search %>
            <%= f.submit "Search", class: "gb-search-button" %>
          </div>
        <% end %>

        <p class="results-count">Displaying <%= @pokemons.count %> pokemon found.</p>

        <div class="search-results">
          <% if @pokemons.any? %>
            <% @pokemons.each do |pokemon| %>
              <div class="result-card">
                <div class="result-sprite">
                  <%= image_tag pokemon.picture, alt: pokemon.name %>
                </div>
                <div class="result-info">
                  <p class="result-name"><%= pokemon.name.capitalize %></p>
                  <div class="result-types">
                    <% if pokemon.type1.present? %>
                      <span class="type-badge type-<%= pokemon.type1.to_s.parameterize %>"><%= pokemon.type1 %></span>
                    <% end %>
                    <% if pokemon.type2.present? %>
                      <span class="type-badge type-<%= pokemon.type2.to_s.parameterize %>"><%= pokemon.type2 %></span>
                    <% end %>
                  </div>
                  <div class="result-stats">
                    <span class="stat-chip">HP <%= pokemon.hp_max %></span>
                    <span class="stat-chip">ATK <%= pokemon.attack %></span>
                    <span class="stat-chip">DEF <%= pokemon.defense %></span>
                    <span class="stat-chip">SPD <%= pokemon.speed %></span>
                  </div>
                </div>
                <div class="result-action">
                  <button class="gb-add" type="button" aria-label="Select">
                    +
                  </button>
                </div>
              </div>
            <% end %>
          <% else %>
            <p class="empty-state">No pokemon found.</p>
          <% end %>
        </div>

        <div class="search-nav">
          <%= link_to "Back to Pokemon List", pokemons_path, class: "menu-link" %>
          <%= link_to "Home", root_path, class: "menu-link" %>
          <%= link_to "Move List", moves_path, class: "menu-link" %>
        </div>
      </div>
    </div>
  </div>
</section>
